{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "3d157d6c",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "import numpy as np\n",
    "from pathlib import Path\n",
    "import pandas as pd\n",
    "from datetime import datetime\n",
    "import os\n",
    "from thermal_lib import *\n",
    "from tqdm import tqdm\n",
    "import pingouin as pg\n",
    "import matplotlib.patches as mpatches\n",
    "import seaborn as sns\n",
    "import matplotlib\n",
    "\n",
    "def plot_avg(var, isDay, draw_sub=True, draw_sem = True, draw_zero = False, ax=None, color='b'):\n",
    "\n",
    "    if ax is None:\n",
    "        fig, ax = plt.subplots(figsize=(6,4))\n",
    "\n",
    "    if draw_zero:\n",
    "        ax.axhline(0,color='k',linestyle='--')\n",
    "\n",
    "    if draw_sub:\n",
    "        for c in var.columns:\n",
    "            ax.plot(var.index, var[c],color,alpha=.1)\n",
    "\n",
    "    avg = var.mean(axis=1) \n",
    "\n",
    "    if draw_sem:\n",
    "        sem = var.sem(axis=1) \n",
    "        ax.fill_between(var.index, avg+sem, avg-sem, alpha=.3, color=color,edgecolor='none')\n",
    "\n",
    "    ax.plot(var.index, avg,color,alpha=1)\n",
    "    xlims = [var.index[0], var.index[-1]]\n",
    "    ax.set_xlim(xlims)\n",
    "    ylims = ax.get_ylim()\n",
    "    ax.fill_between(var.index, y1=ylims[0], y2=ylims[1], where=isDay<1,alpha=.2, color='gray',edgecolor='none')\n",
    "    ax.set_ylim(ylims)\n",
    "    #ax.set_xlabel('Time [Hours]')\n",
    "    \n",
    "def plot_raw(data=None, y=None, x=None, isDay=None, ax=None, hzero=True):\n",
    "    \n",
    "    if ax is None:\n",
    "        fig,ax = plt.subplots(figsize=(8,3))\n",
    "\n",
    "    if x is None:\n",
    "        x = data.index\n",
    "    \n",
    "    if hzero:\n",
    "        ax.axhline(0,color='k',linestyle='--')\n",
    "    \n",
    "    ax.plot(x, data[y] )\n",
    "    ax.set_ylim([data[y].min()*1.1, data[y].max()*1.1 ])\n",
    "    ylims = ax.get_ylim()\n",
    "    ax.fill_between(x, where=data['isDay']==0, \n",
    "                    y1=ylims[0], \n",
    "                    y2=ylims[1], \n",
    "                    color='gray', alpha=.2, edgecolor='None' )\n",
    "\n",
    "    ax.set_xlim([x[0], x[-1]])\n",
    "    return ax\n",
    "\n",
    "def actogram(in_each_day, ax=None, baseline=True,linecolor='tab:blue',isDay=None):\n",
    "    each_day = in_each_day.copy()\n",
    "\n",
    "    each_day = each_day/each_day.abs().max().max()\n",
    "    spacing = 1.5\n",
    "    \n",
    "    mot_day_tick = list()\n",
    "    mot_day_tick_lbl = list()\n",
    "    all_days = len(each_day.columns)\n",
    "    for i,c in enumerate(each_day.columns):    \n",
    "        each_day[c] = each_day[c] + spacing*(all_days-i)\n",
    "        mot_day_tick.append(spacing*(all_days-i))\n",
    "        mot_day_tick_lbl.append(i)\n",
    "    \n",
    "    if ax is None:\n",
    "        fig,ax = plt.subplots(figsize=(4,5))\n",
    "        ax.set_ylabel('Day')\n",
    "        ax.set_xlabel('Hour')\n",
    "    if baseline:\n",
    "        for b in mot_day_tick:\n",
    "            ax.axhline(b,color='k',linestyle='--')\n",
    "    ax.plot(each_day.index,each_day,linecolor)\n",
    "    if isDay is not None:\n",
    "        ylims = ax.get_ylim()\n",
    "        ax.fill_between(isDay.index,y1=ylims[0],y2=ylims[1],where=isDay<1,color='gray',edgecolor='None',alpha=.4)\n",
    "        \n",
    "    ax.set_yticks(mot_day_tick)\n",
    "    #ax.set_yticklabels(mot_day_tick_lbl)\n",
    "    \n",
    "    ax.set_xlim(each_day.index[0],each_day.index[-1])\n",
    "    \n",
    "    if isDay is None:\n",
    "        ylims = ax.get_ylim()\n",
    "    ax.set_ylim(ylims)\n",
    "    \n",
    "\n",
    "\n",
    "def swarmbox(data,x,y,ax=None,palette=None,order=None):\n",
    "    PROPS = {'boxprops':{'facecolor':'none'}}\n",
    "    sns.swarmplot(data=data,x=x,y=y,palette=palette,ax=ax,alpha=.3,order=order)\n",
    "    sns.boxplot(data=data,x=x,y=y,palette=palette,ax=ax,order=order,width=0.3,fliersize=0, **PROPS)\n",
    "\n",
    "    box_patches = [patch for patch in ax.patches if type(patch) == matplotlib.patches.PathPatch]\n",
    "    if len(box_patches) == 0:  \n",
    "        box_patches = ax.artists\n",
    "    num_patches = len(box_patches)\n",
    "    lines_per_boxplot = len(ax.lines) // num_patches\n",
    "    if type(palette)==dict:\n",
    "        palette=[i[1] for i in list(palette.items()) ]\n",
    "    for i, patch in enumerate(box_patches):\n",
    "        if i==0:\n",
    "            col=palette[0]\n",
    "        else:\n",
    "            col=palette[1]\n",
    "        patch.set_edgecolor(col)\n",
    "        for line in ax.lines[i * lines_per_boxplot: (i + 1) * lines_per_boxplot]:\n",
    "            line.set_color(col)\n",
    "    \n",
    "%matplotlib notebook"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "835e2b0c",
   "metadata": {},
   "outputs": [],
   "source": [
    "\n",
    "pth = r'D:\\thermography\\cdkl5_thermal_behaviour_group1\\unico'\n",
    "#pth = None\n",
    "sub = Subjects(pth)\n",
    "print(sub)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "d6ba2c2b",
   "metadata": {},
   "outputs": [],
   "source": [
    "isDay = list()\n",
    "temperature = dict()\n",
    "motion = dict()\n",
    "for info,rec in tqdm( sub.iter_data() , total=len(sub) ):\n",
    "    #rec = rec.sort_values(by='minute').reset_index(drop=True)\n",
    "    motion[(info['geno'], info['id'])] = rec['distance']\n",
    "    temperature[(info['geno'], info['id'])] = rec['temp_rt_diff']\n",
    "    isDay.append(rec['isDay'])\n",
    "\n",
    "isDay = pd.concat(isDay,axis=1).mean(axis=1)\n",
    "motion = pd.DataFrame.from_dict(motion)\n",
    "temperature = pd.DataFrame.from_dict(temperature,)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "285a00bd",
   "metadata": {},
   "outputs": [],
   "source": [
    "fig,ax = plt.subplots(2,1,sharex=True, figsize=(7,4)) \n",
    "plot_avg( temperature.xs('KO',level=0,axis=1), isDay,color='m',ax=ax[0])\n",
    "plot_avg( temperature.xs('WT',level=0,axis=1), isDay,color='c',ax=ax[0])\n",
    "ax[0].set_ylabel('Temperature from RT \\n[Degree]')\n",
    "ax2 = ax[0].secondary_xaxis(\"top\", functions=(lambda x: x/60, lambda x: x*60))\n",
    "ax2.set_xlabel('Hour')\n",
    "\n",
    "plot_avg( motion.xs('KO',level=0,axis=1), isDay,color='m', ax=ax[1])\n",
    "plot_avg( motion.xs('WT',level=0,axis=1), isDay,color='c', ax=ax[1])\n",
    "ax[1].set_ylabel('Distance \\n[pixel]')\n",
    "ax[1].set_xlabel('Minute')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "a1398a8e",
   "metadata": {},
   "outputs": [],
   "source": [
    "temp_wt = temperature.xs('WT',level=0,axis=1)\n",
    "import numpy as np\n",
    "from scipy import signal\n",
    "from scipy.fft import fftshift\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "4a71c830",
   "metadata": {},
   "outputs": [],
   "source": [
    "%notebook inline\n",
    "x = temp_wt.iloc[:,0]\n",
    "fs = 60\n",
    "nperseg = int(480)\n",
    "f, t, Sxx = signal.spectrogram(x, fs,nperseg=nperseg,noverlap=nperseg-20,nfft=10000)\n",
    "time_x = np.linspace(t[0],t[-1],len(x))\n",
    "x.index = time_x\n",
    "\n",
    "fig,ax = plt.subplots(2,1,sharex=True)\n",
    "\n",
    "ax[0].plot(x)\n",
    "ylims = ax[0].get_ylim()\n",
    "ax[0].fill_between(x.index, y1=ylims[0], y2=ylims[1], where=isDay<1,alpha=.2, color='gray',edgecolor='none')\n",
    "foi = np.where((f<1)&(f>0.015))[0]\n",
    "ax[1].pcolormesh(t, np.nan_to_num(1/f[foi],posinf=0), Sxx[foi,:], shading='gouraud',cmap='jet')\n",
    "ax[1].set_ylabel('Period')\n",
    "ax[1].set_xlabel('Time [sec]')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "13483882",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet()\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "imshow(Wx, **ikw, yticks=freqs_cwt)\n",
    "imshow(Sx, **ikw, yticks=freqs_stft)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "19afc76c",
   "metadata": {},
   "outputs": [],
   "source": [
    "%notebook inline\n",
    "x = temp_wt.iloc[:,0]\n",
    "fs = 60\n",
    "nperseg = int(480)\n",
    "f, t, Sxx = signal.spectrogram(x, fs,nperseg=nperseg,noverlap=nperseg-20,nfft=10000)\n",
    "time_x = np.linspace(t[0],t[-1],len(x))\n",
    "x.index = time_x\n",
    "\n",
    "fig,ax = plt.subplots(2,1,sharex=True)\n",
    "\n",
    "ax[0].plot(x)\n",
    "ylims = ax[0].get_ylim()\n",
    "ax[0].fill_between(x.index, y1=ylims[0], y2=ylims[1], where=isDay<1,alpha=.2, color='gray',edgecolor='none')\n",
    "foi = np.where((f<1)&(f>0.015))[0]\n",
    "ax[1].pcolormesh(t, np.nan_to_num(1/f[foi],posinf=0), Sxx[foi,:], shading='gouraud',cmap='jet')\n",
    "ax[1].set_ylabel('Period')\n",
    "ax[1].set_xlabel('Time [sec]')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "05b5360d",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet()\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "\n",
    "imshow(Wx, **ikw, yticks=freqs_cwt,ax=ax[0])\n",
    "imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "135721d8",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet()\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "\n",
    "imshow(Wx, **ikw, yticks=freqs_cwt,ax=ax[0])\n",
    "imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "0488000f",
   "metadata": {},
   "outputs": [],
   "source": [
    "freqs_cwt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "bdb83eba",
   "metadata": {},
   "outputs": [],
   "source": [
    "1/freqs_cwt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "55036654",
   "metadata": {},
   "outputs": [],
   "source": [
    "1/freqs_cwt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "25e7a216",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet()\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "\n",
    "imshow(Wx, **ikw, yticks=1/freqs_cwt,ax=ax[0])\n",
    "imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "714d32e5",
   "metadata": {},
   "outputs": [],
   "source": [
    "ikw"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "b46bcbf1",
   "metadata": {},
   "outputs": [],
   "source": [
    "Wx"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "419ba3a2",
   "metadata": {},
   "outputs": [],
   "source": [
    "Wx.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "1ec95924",
   "metadata": {},
   "outputs": [],
   "source": [
    "Wx.shape\n",
    "freqs_cwt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "a898ad3b",
   "metadata": {},
   "outputs": [],
   "source": [
    "Wx.shape , freqs_cwt.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "d9e42cb0",
   "metadata": {},
   "outputs": [],
   "source": [
    "Wx.shape , \n",
    "freqs_cwt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "58f280e9",
   "metadata": {},
   "outputs": [],
   "source": [
    "Wx.shape , \n",
    "1/freqs_cwt"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "709776ef",
   "metadata": {},
   "outputs": [],
   "source": [
    "Wx.shape ,\n",
    "period_cwt = 1/freqs_cwt\n",
    "np.where((period_cwt<30)and(period_cwt>1))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "61069de5",
   "metadata": {},
   "outputs": [],
   "source": [
    "Wx.shape ,\n",
    "period_cwt = 1/freqs_cwt\n",
    "np.where((period_cwt<30)&(period_cwt>1))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "245d1a02",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet()\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<30)&(period_cwt>1))\n",
    "imshow(Wx[poi,:], **ikw, yticks=period_cwt[poi,:],ax=ax[0])\n",
    "imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "ccf73f2e",
   "metadata": {},
   "outputs": [],
   "source": [
    "Wx.shape ,\n",
    "Wx[poi,:]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "f20ef4aa",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet()\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<30)&(period_cwt>1))\n",
    "imshow(Wx[poi,:], **ikw, yticks=period_cwt[poi],ax=ax[0])\n",
    "imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "3081f12f",
   "metadata": {},
   "outputs": [],
   "source": [
    "Wx.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "08d47cac",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet()\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<30)&(period_cwt>1))\n",
    "imshow(Wx[poi,:], **ikw )#, yticks=period_cwt[poi],ax=ax[0])\n",
    "imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "d5bb546b",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet()\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<30)&(period_cwt>1))\n",
    "imshow(Wx[poi,:], **ikw )#, yticks=period_cwt[poi],ax=ax[0])\n",
    "#imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "9ab4fb58",
   "metadata": {},
   "outputs": [],
   "source": [
    "Wx[poi,:]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "6091d3f8",
   "metadata": {},
   "outputs": [],
   "source": [
    "Wx[poi,:].shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "6dd32e71",
   "metadata": {},
   "outputs": [],
   "source": [
    "Wx.shape #[poi,:].shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "1ba546f8",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet()\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<30)&(period_cwt>1))[0]\n",
    "imshow(Wx[poi,:], **ikw )#, yticks=period_cwt[poi],ax=ax[0])\n",
    "#imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "944861a9",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet()\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<30)&(period_cwt>1))[0]\n",
    "imshow(Wx[poi,:], **ikw, yticks=period_cwt[poi],ax=ax[0])\n",
    "#imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "f80983b7",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet()\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<30)&(period_cwt>1))[0]\n",
    "#imshow(Wx[poi,:], **ikw, yticks=period_cwt[poi],ax=ax[0])\n",
    "ax[0].pcolormesh(t, period_cwt[poi], Wx[poi,:], shading='gouraud',cmap='jet')\n",
    "#imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "fdec803f",
   "metadata": {},
   "outputs": [],
   "source": [
    " Wx[poi,:]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "6de81c47",
   "metadata": {},
   "outputs": [],
   "source": [
    "Wx[poi,:].abs()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "3223b1b8",
   "metadata": {},
   "outputs": [],
   "source": [
    "np.abs(Wx[poi,:])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "d6e3dd1f",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet()\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<30)&(period_cwt>1))[0]\n",
    "#imshow(Wx[poi,:], **ikw, yticks=period_cwt[poi],ax=ax[0])\n",
    "ax[0].pcolormesh(t, period_cwt[poi], np.abs(Wx[poi,:]), shading='gouraud',cmap='jet')\n",
    "#imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "2fa0f251",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet()\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<50)&(period_cwt>1))[0]\n",
    "#imshow(Wx[poi,:], **ikw, yticks=period_cwt[poi],ax=ax[0])\n",
    "ax[0].pcolormesh(t, period_cwt[poi], np.abs(Wx[poi,:]), shading='gouraud',cmap='jet')\n",
    "#imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "8be0b008",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet(N=2048)\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<50)&(period_cwt>1))[0]\n",
    "#imshow(Wx[poi,:], **ikw, yticks=period_cwt[poi],ax=ax[0])\n",
    "ax[0].pcolormesh(t, period_cwt[poi], np.abs(Wx[poi,:]), shading='gouraud',cmap='jet')\n",
    "#imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "0709a716",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet(N=1**32)\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<50)&(period_cwt>1))[0]\n",
    "#imshow(Wx[poi,:], **ikw, yticks=period_cwt[poi],ax=ax[0])\n",
    "ax[0].pcolormesh(t, period_cwt[poi], np.abs(Wx[poi,:]), shading='gouraud',cmap='jet')\n",
    "#imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "2e85db96",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet(N=1**64)\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<50)&(period_cwt>1))[0]\n",
    "#imshow(Wx[poi,:], **ikw, yticks=period_cwt[poi],ax=ax[0])\n",
    "ax[0].pcolormesh(t, period_cwt[poi], np.abs(Wx[poi,:]), shading='gouraud',cmap='jet')\n",
    "#imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "3b9e6f04",
   "metadata": {},
   "outputs": [],
   "source": [
    "1/24"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "2d57d455",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet(N=1**64)\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<50)&(period_cwt>1))[0]\n",
    "#imshow(Wx[poi,:], **ikw, yticks=period_cwt[poi],ax=ax[0])\n",
    "ax[0].pcolormesh(t, freqs_cwt[poi], np.abs(Wx[poi,:]), shading='gouraud',cmap='jet')\n",
    "#imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "911d76df",
   "metadata": {},
   "outputs": [],
   "source": [
    "1/0.4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "777b3036",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet(N=1**64)\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<50)&(period_cwt>2))[0]\n",
    "#imshow(Wx[poi,:], **ikw, yticks=period_cwt[poi],ax=ax[0])\n",
    "ax[0].pcolormesh(t, freqs_cwt[poi], np.abs(Wx[poi,:]), shading='gouraud',cmap='jet')\n",
    "#imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "c64e8dac",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet(N=1**64)\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,7)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<50)&(period_cwt>2))[0]\n",
    "#imshow(Wx[poi,:], **ikw, yticks=period_cwt[poi],ax=ax[0])\n",
    "ax[0].pcolormesh(t, freqs_cwt[poi], np.abs(Wx[poi,:]), shading='gouraud',cmap='jet')\n",
    "#imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "30aef0bc",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet(N=1**64)\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<50)&(period_cwt>7))[0]\n",
    "#imshow(Wx[poi,:], **ikw, yticks=period_cwt[poi],ax=ax[0])\n",
    "ax[0].pcolormesh(t, freqs_cwt[poi], np.abs(Wx[poi,:]), shading='gouraud',cmap='jet')\n",
    "#imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "d2e0cafd",
   "metadata": {},
   "outputs": [],
   "source": [
    "1/0.8"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "8bdf235f",
   "metadata": {},
   "outputs": [],
   "source": [
    "1/4"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "1910b413",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet(N=1**64)\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<50)&(period_cwt>5))[0]\n",
    "#imshow(Wx[poi,:], **ikw, yticks=period_cwt[poi],ax=ax[0])\n",
    "ax[0].pcolormesh(t, freqs_cwt[poi], np.abs(Wx[poi,:]), shading='gouraud',cmap='jet')\n",
    "#imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "e40ffbe5",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet(N=1**64)\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<50)&(period_cwt>3))[0]\n",
    "#imshow(Wx[poi,:], **ikw, yticks=period_cwt[poi],ax=ax[0])\n",
    "ax[0].pcolormesh(t, freqs_cwt[poi], np.abs(Wx[poi,:]), shading='gouraud',cmap='jet')\n",
    "#imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "164a140a",
   "metadata": {},
   "outputs": [],
   "source": [
    "1/0.2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "c48b86ad",
   "metadata": {},
   "outputs": [],
   "source": [
    "1/0.3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "9cf4a07a",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet(N=1**64)\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<50)&(period_cwt>.1))[0]\n",
    "#imshow(Wx[poi,:], **ikw, yticks=period_cwt[poi],ax=ax[0])\n",
    "ax[0].pcolormesh(t, freqs_cwt[poi], np.abs(Wx[poi,:]), shading='gouraud',cmap='jet')\n",
    "#imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "72f59cae",
   "metadata": {},
   "outputs": [],
   "source": [
    "1/0.45"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "id": "f50449c2",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet(N=1**64)\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<50)&(period_cwt>1))[0]\n",
    "#imshow(Wx[poi,:], **ikw, yticks=period_cwt[poi],ax=ax[0])\n",
    "ax[0].pcolormesh(t, freqs_cwt[poi], np.abs(Wx[poi,:]), shading='gouraud',cmap='jet')\n",
    "#imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "18ff9eb4",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from ssqueezepy import ssq_cwt, ssq_stft\n",
    "from ssqueezepy.experimental import scale_to_freq\n",
    "from ssqueezepy import Wavelet, cwt, stft, imshow\n",
    "\n",
    "N = len(x)\n",
    "fs = 60\n",
    "t = np.linspace(0, N/fs, N)\n",
    "wavelet = Wavelet(N=1**64)\n",
    "Wx, scales = cwt(x, wavelet)\n",
    "Sx = stft(x)[::-1]\n",
    "\n",
    "freqs_cwt = scale_to_freq(scales, wavelet, len(x), fs=fs)\n",
    "freqs_stft = np.linspace(1, 0, len(Sx)) * fs/2\n",
    "\n",
    "ikw = dict(abs=1, xticks=t, xlabel=\"Time [sec]\", ylabel=\"Frequency [Hz]\")\n",
    "\n",
    "fig,ax=plt.subplots(2,1)\n",
    "period_cwt = 1/freqs_cwt\n",
    "poi = np.where((period_cwt<50)&(period_cwt>1))[0]\n",
    "#imshow(Wx[poi,:], **ikw, yticks=period_cwt[poi],ax=ax[0])\n",
    "ax[0].pcolormesh(t, period_cwt[poi], np.abs(Wx[poi,:]), shading='gouraud',cmap='jet')\n",
    "#imshow(Sx, **ikw, yticks=freqs_stft,ax=ax[1])"
   ]
  }
 ],
 "metadata": {},
 "nbformat": 4,
 "nbformat_minor": 5
}
